{"remainingRequest":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\babel-loader\\lib\\index.js!D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\src\\views\\userprofile\\components\\update-photo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\src\\views\\userprofile\\components\\update-photo.vue","mtime":1645498622000},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\babel.config.js","mtime":1645498622000},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674635617236},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\babel-loader\\lib\\index.js","mtime":1674635619784},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674635617236},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\vue-loader\\lib\\index.js","mtime":1674635619517}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6XFxXZWJfREVWX0lOR1xcVnVlLmpzX3RlY2huaWNhbF9mcmFtZXdvcmtcXFZ1ZTJcdTk4NzlcdTc2RUVcdTVCOUVcdTYyMThcXEhlaW1hdG91dGlhby1tYWluXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxhc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyB1cGRhdGVVc2VyUGhvdG8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IENyb3BwZXIgZnJvbSAnY3JvcHBlcmpzJzsKaW1wb3J0ICdjcm9wcGVyanMvZGlzdC9jcm9wcGVyLmNzcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndXBkYXRlUGhvdG8nLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwaG90bzogd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5maWxlKSwKICAgICAgY3JvcHBlcjogbnVsbAogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICBmaWxlOiB7CiAgICAgIHR5cGU6IFtPYmplY3QsIEZpbGVdLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBpbWFnZSA9IHRoaXMuJHJlZnMuaW1hZ2U7CiAgICB0aGlzLmNyb3BwZXIgPSBuZXcgQ3JvcHBlcihpbWFnZSwgewogICAgICB2aWV3TW9kZTogMSwKICAgICAgZHJhZ01vZGU6ICdtb3ZlJywKICAgICAgYXNwZWN0UmF0aW86IDEsCiAgICAgIGF1dG9Dcm9wQXJlYTogMSwKICAgICAgY3JvcEJveE1vdmFibGU6IHRydWUsCiAgICAgIGNyb3BCb3hSZXNpemFibGU6IHRydWUsCiAgICAgIGJhY2tncm91bmQ6IGZhbHNlLAogICAgICBtb3ZhYmxlOiB0cnVlCiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldENyb3BwZWRDYW52YXM6IGZ1bmN0aW9uIGdldENyb3BwZWRDYW52YXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBfdGhpcy5jcm9wcGVyLmdldENyb3BwZWRDYW52YXMoKS50b0Jsb2IoZnVuY3Rpb24gKGJsb2IpIHsKICAgICAgICAgIHJlc29sdmUoYmxvYik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIG9uQ29uZmlybTogZnVuY3Rpb24gb25Db25maXJtKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGZpbGUsIGZkOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMi4kdG9hc3QubG9hZGluZyh7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5LiK5Lyg5Litfn5+JywKICAgICAgICAgICAgICAgICAgZm9yYmlkY2xpY2s6IHRydWUsCiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwCiAgICAgICAgICAgICAgICB9KTsgLy8g5bCB6KOF5LqG5LiA5LiqZ2V0Q3JvcHBlcuWHveaVsO+8jOiOt+WPluijgeWJquWQjueahOWbvueJhwoKCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuZ2V0Q3JvcHBlZENhbnZhcygpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBmaWxlID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIGZkID0gbmV3IEZvcm1EYXRhKCk7IC8vIOS8oOWFpeaWh+S7tuWvueixoeW5tui9rOaIkGZvcm1EYXRhCgogICAgICAgICAgICAgICAgZmQuYXBwZW5kKCdwaG90bycsIGZpbGUpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlVXNlclBob3RvKGZkKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgX3RoaXMyLiR0b2FzdC5zdWNjZXNzKCfkuIrkvKDmiJDlip/vvIEnKTsKCiAgICAgICAgICAgICAgICBfdGhpczIuJGVtaXQoJ2Nsb3NlJyk7CgogICAgICAgICAgICAgICAgX3RoaXMyLiRlbWl0KCd1cGRhdGUtcGhvdG8nLCB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["update-photo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAWA,SACA,eADA,QAEA,YAFA;AAGA,OAAA,OAAA,MAAA,WAAA;AACA,OAAA,4BAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,MAAA,CAAA,GAAA,CAAA,eAAA,CAAA,KAAA,IAAA,CADA;AAEA,MAAA,OAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,IAAA,EAAA,CAAA,MAAA,EAAA,IAAA,CADA;AAEA,MAAA,QAAA,EAAA;AAFA;AADA,GARA;AAcA,EAAA,OAdA,qBAcA;AACA,QAAA,KAAA,GAAA,KAAA,KAAA,CAAA,KAAA;AACA,SAAA,OAAA,GAAA,IAAA,OAAA,CAAA,KAAA,EAAA;AACA,MAAA,QAAA,EAAA,CADA;AAEA,MAAA,QAAA,EAAA,MAFA;AAGA,MAAA,WAAA,EAAA,CAHA;AAIA,MAAA,YAAA,EAAA,CAJA;AAKA,MAAA,cAAA,EAAA,IALA;AAMA,MAAA,gBAAA,EAAA,IANA;AAOA,MAAA,UAAA,EAAA,KAPA;AAQA,MAAA,OAAA,EAAA;AARA,KAAA,CAAA;AAUA,GA1BA;AA2BA,EAAA,OAAA,EAAA;AACA,IAAA,gBADA,8BACA;AAAA;;AACA,aAAA,IAAA,OAAA,CAAA,UAAA,OAAA,EAAA;AACA,QAAA,KAAA,CAAA,OAAA,CAAA,gBAAA,GAAA,MAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,OAAA,CAAA,IAAA,CAAA;AACA,SAFA;AAGA,OAJA,CAAA;AAKA,KAPA;AAQA,IAAA,SARA,uBAQA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,MAAA,CAAA,MAAA,CAAA,OAAA,CAAA;AACA,kBAAA,KAAA,EAAA,QADA;AAEA,kBAAA,WAAA,EAAA,IAFA;AAGA,kBAAA,QAAA,EAAA;AAHA,iBAAA,EADA,CAMA;;;AANA;AAAA,uBAOA,MAAA,CAAA,gBAAA,EAPA;;AAAA;AAOA,gBAAA,IAPA;AAQA,gBAAA,EARA,GAQA,IAAA,QAAA,EARA,EASA;;AACA,gBAAA,EAAA,CAAA,MAAA,CAAA,OAAA,EAAA,IAAA;AAVA;AAAA,uBAWA,eAAA,CAAA,EAAA,CAXA;;AAAA;AAaA,gBAAA,MAAA,CAAA,MAAA,CAAA,OAAA,CAAA,OAAA;;AACA,gBAAA,MAAA,CAAA,KAAA,CAAA,OAAA;;AACA,gBAAA,MAAA,CAAA,KAAA,CAAA,cAAA,EAAA,MAAA,CAAA,GAAA,CAAA,eAAA,CAAA,IAAA,CAAA;;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AAxBA;AA3BA,CAAA","sourcesContent":["<template>\n    <div class=\"photo-show\">\n        <div class=\"imgbox\">\n            <img class=\"img\" :src=\"photo\" ref=\"image\"/>\n        </div>\n        <van-nav-bar class=\"toolbar\" left-text=\"关闭\" right-text=\"完成\" @click-left=\"$emit('close')\"\n            @click-right=\"onConfirm\" />\n    </div>\n</template>\n\n<script>\n    import {\n        updateUserPhoto\n    } from '@/api/user';\n    import Cropper from 'cropperjs';\n    import 'cropperjs/dist/cropper.css';\n    export default {\n        name: 'updatePhoto',\n        data() {\n            return {\n                photo: window.URL.createObjectURL(this.file),\n                cropper:null\n            }\n        },\n        props: {\n            file: {\n                type: [Object, File],\n                required: true\n            }\n        },\n        mounted(){\n            const image = this.$refs.image;\n            this.cropper = new Cropper(image, {\n                viewMode:1,\n                dragMode:'move',\n                aspectRatio:1,\n                autoCropArea:1,\n                cropBoxMovable:true,\n                cropBoxResizable:true,\n                background:false,\n                movable:true\n            });\n        },\n        methods: {\n            getCroppedCanvas(){\n                return new Promise(resolve=>{\n                    this.cropper.getCroppedCanvas().toBlob((blob)=>{\n                        resolve(blob)\n                    })\n                })\n            },\n            async onConfirm() {\n                this.$toast.loading({\n                    title: '上传中~~~',\n                    forbidclick: true,\n                    duration:0\n                })\n                // 封装了一个getCropper函数，获取裁剪后的图片\n                const file=await this.getCroppedCanvas();\n                const fd = new FormData();\n                // 传入文件对象并转成formData\n                fd.append('photo', file)\n                await updateUserPhoto(fd)\n\n                this.$toast.success('上传成功！');\n                this.$emit('close');\n                this.$emit('update-photo', window.URL.createObjectURL(file));\n            }\n        },\n    }\n</script>\n\n<style lang=\"less\" scoped>\n    .photo-show{\n        display: flex;\n        position: absolute;\n        justify-content: center;\n        align-items: center;\n        width: 100%;\n        height: 100%;\n        bottom: 44px;\n    }\n    .toolbar {\n        position: fixed;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(255, 254, 254, 0.959);\n    }\n    \n    \n    /deep/ .van-nav-bar__content {\n        background-color: rgba(247, 247, 247, 0.144);\n    }\n    .img{\n        display: block;\n        max-width: 100%;\n    }\n</style>"],"sourceRoot":"src/views/userprofile/components"}]}