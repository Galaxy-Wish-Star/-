{"remainingRequest":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\src\\views\\home\\components\\article-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\src\\views\\home\\components\\article-list.vue","mtime":1645498622000},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674635617236},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\babel-loader\\lib\\index.js","mtime":1674635619784},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1674635617236},{"path":"D:\\Web_DEV_ING\\Vue.js_technical_framework\\Vue2项目实战\\Heimatoutiao-main\\node_modules\\vue-loader\\lib\\index.js","mtime":1674635619517}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0Q2hhbm5lbEJ5SWR9IGZyb20gJ0AvYXBpL2FydGljbGUnOwppbXBvcnQgQXJ0aWNsZUl0ZW0gZnJvbSAnQC9jb21wb25lbnRzL2FydGljbGUtaXRlbSc7CmltcG9ydCB7ZGVib3VuY2V9IGZyb20gJ2xvZGFzaCc7CmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdBcnRpY2xlbGlzdCcsCiAgICBjb21wb25lbnRzOnsKICAgICAgICBBcnRpY2xlSXRlbQogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgIGZpbmlzaGVkOiBmYWxzZSwKICAgICAgICAgICAgYXJ0aWNsZXM6IFtdLAogICAgICAgICAgICB0aW1lc3RhbXA6IDAsCiAgICAgICAgICAgIGlzUHVsbFJlZnJlc2g6ZmFsc2UsCiAgICAgICAgICAgIHJlZnJlc2hTdWNjZXNzVGV4dDonJwogICAgICAgIH0KICAgIH0sCiAgICBhY3RpdmF0ZWQoKXsKICAgICAgICB0aGlzLiRyZWZzWydhcnRpY2xlLWxpc3QnXS5zY3JvbGxUb3A9dGhpcy5zY3JvbGxUb3AKICAgIH0sCiAgICBwcm9wczogewogICAgICAgIGNoYW5uZWw6IHsKICAgICAgICAgICAgdHlwZTogT2JqZWN0LAogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIGNvbnN0IGFydGljbGVMaXN0ID0gdGhpcy4kcmVmc1snYXJ0aWNsZS1saXN0J107CiAgICAgICAgYXJ0aWNsZUxpc3Qub25zY3JvbGwgPSBkZWJvdW5jZSggKCkgPT57CiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wPWFydGljbGVMaXN0LnNjcm9sbFRvcDsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zY3JvbGxUb3ApOwogICAgICAgIH0sNTApCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGFzeW5jIG9uTG9hZCgpIHsKICAgICAgICAgICAgLy8g5byC5q2l5pu05paw5pWw5o2uCiAgICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgICAgIGRhdGEKICAgICAgICAgICAgfSA9IGF3YWl0IGdldENoYW5uZWxCeUlkKHsKICAgICAgICAgICAgICAgIGNoYW5uZWxfaWQ6IHRoaXMuY2hhbm5lbC5pZCwKICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGhpcy50aW1lc3RhbXAgPT09IDAgPyBEYXRlLm5vdygpIDogdGhpcy50aW1lc3RhbXAsCiAgICAgICAgICAgICAgICB3aXRoX3RvcDowCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb25zdCByZXN1bHQgPSBkYXRhLmRhdGEucmVzdWx0czsKICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBkYXRhLmRhdGEucHJlX3RpbWVzdGFtcCB8fCAwOwogICAgICAgICAgICByZXN1bHQuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuYXJ0aWNsZXMucHVzaChpdGVtKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAvLyDlpoLmnpzor7fmsYLkuI3liLDmlbDmja7kuobvvIzlsLHnu5PmnZ/or7fmsYIKICAgICAgICAgICAgaWYgKHRoaXMudGltZXN0YW1wID09PSAwKSB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIC8vIOS4i+aLieWIt+aWsAogICAgICAgIGFzeW5jIG9uUmVmcmVzaCgpewogICAgICAgICAgICAvLyDor7fmsYLojrflj5bmlbDmja4KICAgICAgICAgICAgLy8g5pWw5o2udW5zaGlmdAogICAgICAgICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBnZXRDaGFubmVsQnlJZCh7CiAgICAgICAgICAgICAgICBjaGFubmVsX2lkOiB0aGlzLmNoYW5uZWwuaWQsCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksCiAgICAgICAgICAgICAgICB3aXRoX3RvcDowCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb25zdCByZXN1bHQgPSBkYXRhLmRhdGEucmVzdWx0czsKICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmFydGljbGVzLnVuc2hpZnQoaXRlbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnJlZnJlc2hTdWNjZXNzVGV4dD1g5pu05paw5LqGJHtyZXN1bHQubGVuZ3RofeadoeaVsOaNrmA7CiAgICAgICAgICAgIHRoaXMuaXNQdWxsUmVmcmVzaD1mYWxzZTsKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["article-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"article-list.vue","sourceRoot":"src/views/home/components","sourcesContent":["<template>\n    <div class=\"article-cotainer\" ref=\"article-list\">\n        <!-- 下拉刷新容器 -->\n        <van-pull-refresh \n        v-model=\"isPullRefresh\" \n        :success-text=\"refreshSuccessText\"\n        :success-duration=\"500\"\n        @refresh=\"onRefresh\">\n            <!-- 渲染组件块 -->\n            <van-list v-model=\"loading\" \n            :finished=\"finished\" \n            finished-text=\"没有更多了\" \n            @load=\"onLoad\">\n                <!-- 单元格结构 -->\n                <article-item\n                v-for=\"(item,index) in articles\" \n                :key=\"index\"\n                :article=\"item\"\n                />\n            </van-list>\n        </van-pull-refresh>\n    </div>\n</template>\n\n<script>\n    import {getChannelById} from '@/api/article';\n    import ArticleItem from '@/components/article-item';\n    import {debounce} from 'lodash';\n    export default {\n        name: 'Articlelist',\n        components:{\n            ArticleItem\n        },\n        data() {\n            return {\n                loading: false,\n                finished: false,\n                articles: [],\n                timestamp: 0,\n                isPullRefresh:false,\n                refreshSuccessText:''\n            }\n        },\n        activated(){\n            this.$refs['article-list'].scrollTop=this.scrollTop\n        },\n        props: {\n            channel: {\n                type: Object,\n                required: true\n            }\n        },\n        mounted() {\n            const articleList = this.$refs['article-list'];\n            articleList.onscroll = debounce( () =>{\n                this.scrollTop=articleList.scrollTop;\n                console.log(this.scrollTop);\n            },50)\n        },\n        methods: {\n            async onLoad() {\n                // 异步更新数据\n                const {\n                    data\n                } = await getChannelById({\n                    channel_id: this.channel.id,\n                    timestamp: this.timestamp === 0 ? Date.now() : this.timestamp,\n                    with_top:0\n                });\n                const result = data.data.results;\n                this.timestamp = data.data.pre_timestamp || 0;\n                result.forEach(item => {\n                    this.articles.push(item);\n                });\n                this.loading = false;\n                // 如果请求不到数据了，就结束请求\n                if (this.timestamp === 0) this.finished = true;\n            },\n            // 下拉刷新\n            async onRefresh(){\n                // 请求获取数据\n                // 数据unshift\n                const {data} = await getChannelById({\n                    channel_id: this.channel.id,\n                    timestamp: Date.now(),\n                    with_top:0\n                });\n                const result = data.data.results;\n                result.forEach(item => {\n                    this.articles.unshift(item);\n                });\n                this.refreshSuccessText=`更新了${result.length}条数据`;\n                this.isPullRefresh=false;\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"less\">\n    .article-cotainer {\n        position: fixed;\n        left: 0;\n        right: 0;\n        bottom: 50px;\n        top: 90px;\n        overflow-y: auto;\n    }\n</style>"]}]}